<!DOCTYPE html>
<html>
<head>
    <title>SPACE TYCOON: CYBER VIBES</title>
    <style>
        :root { --neon-blue: #00f2ff; --neon-pink: #ff0077; --gold: #ffcc00; }
        body { margin: 0; overflow: hidden; background: #1a1a2e; font-family: 'Segoe UI', sans-serif; }
        
        #ui { position: absolute; top: 20px; left: 20px; color: white; background: rgba(255, 255, 255, 0.1); 
               padding: 20px; border-radius: 15px; border: 2px solid var(--neon-blue); backdrop-filter: blur(5px); pointer-events: none; }
        #money { font-size: 36px; color: #00ff88; font-weight: bold; text-shadow: 0 0 10px rgba(0,255,136,0.5); }
        .label { font-size: 12px; font-weight: bold; color: var(--neon-blue); text-transform: uppercase; }
        
        #controls { position: absolute; bottom: 20px; left: 20px; color: white; opacity: 0.6; font-size: 14px; }
    </style>
</head>
<body>

    <div id="ui">
        <div class="label">Colony Credits</div>
        <div id="money">§ 50</div>
        <div id="income" style="font-size: 14px; color: white;">Income: §0/sec</div>
    </div>

    <div id="controls">WASD to Move | SPACE to Jump | Click the Gold Crystal for §1</div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
    </script>

    <script type="module">
        import * as THREE from 'three';

        // --- VISUAL SETUP ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x222244); // Brighter, purple-toned sky
        scene.fog = new THREE.Fog(0x222244, 10, 100);

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // --- BRIGHTER LIGHTING ---
        scene.add(new THREE.AmbientLight(0xffffff, 0.8)); // Stronger ambient light
        const sun = new THREE.DirectionalLight(0xffffff, 1.2);
        sun.position.set(10, 20, 10);
        scene.add(sun);

        // --- NEON GROUND ---
        const floor = new THREE.Mesh(new THREE.PlaneGeometry(500, 500), new THREE.MeshStandardMaterial({ color: 0x333355 }));
        floor.rotation.x = -Math.PI / 2;
        scene.add(floor);
        const grid = new THREE.GridHelper(200, 40, 0x00f2ff, 0x444488);
        scene.add(grid);

        // --- THE PLAYER ---
        const player = new THREE.Group();
        const suit = new THREE.Mesh(new THREE.CapsuleGeometry(0.4, 0.8), new THREE.MeshStandardMaterial({color: 0xffffff}));
        suit.position.y = 0.9;
        player.add(suit);
        scene.add(player);

        // --- CLICKER CRYSTAL ---
        const crystal = new THREE.Mesh(new THREE.OctahedronGeometry(1.5, 0), new THREE.MeshStandardMaterial({color: 0xffcc00, emissive: 0xffcc00, emissiveIntensity: 0.5}));
        crystal.position.set(0, 2.5, 0);
        scene.add(crystal);

        // --- TYCOON LOGIC ---
        let money = 50;
        let income = 0;
        let vY = 0, isJumping = false;
        const buyPads = [];

        function createBuyPad(x, z, cost, label, color, onPurchase) {
            const pad = new THREE.Group();
            const ring = new THREE.Mesh(new THREE.TorusGeometry(2, 0.15, 16, 32), new THREE.MeshBasicMaterial({color: color}));
            ring.rotation.x = Math.PI/2;
            pad.add(ring);
            pad.position.set(x, 0.1, z);
            pad.userData = { cost, active: true, onPurchase };
            scene.add(pad);
            buyPads.push(pad);
        }

        // Spawn first pad
        createBuyPad(8, 8, 50, "Miner", 0x00ff88, () => {
            income += 5;
            const b = new THREE.Mesh(new THREE.BoxGeometry(2, 6, 2), new THREE.MeshStandardMaterial({color: 0xff0077}));
            b.position.set(8, 3, 12);
            scene.add(b);
            // Unlock next
            createBuyPad(-8, 8, 200, "Factory", 0xff0077, () => {
                income += 25;
                const b2 = new THREE.Mesh(new THREE.CylinderGeometry(2, 3, 8), new THREE.MeshStandardMaterial({color: 0x00f2ff}));
                b2.position.set(-8, 4, 12);
                scene.add(b2);
            });
        });

        // --- CONTROLS ---
        const keys = {};
        window.addEventListener('keydown', (e) => {
            keys[e.code] = true;
            if(e.code === 'Space' && !isJumping) { vY = 0.3; isJumping = true; }
        });
        window.addEventListener('keyup', (e) => keys[e.code] = false);

        // Clicking the Crystal
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();
        window.addEventListener('mousedown', (e) => {
            mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            if(raycaster.intersectObject(crystal).length > 0) {
                money += 1;
                crystal.scale.set(1.3, 1.3, 1.3);
            }
        });

        function animate() {
            requestAnimationFrame(animate);
            if(keys['KeyW']) player.translateZ(0.2);
            if(keys['KeyS']) player.translateZ(-0.2);
            if(keys['KeyA']) player.rotation.y += 0.05;
            if(keys['KeyD']) player.rotation.y -= 0.05;

            // Jump Physics
            vY -= 0.01;
            player.position.y += vY;
            if(player.position.y <= 0) { player.position.y = 0; vY = 0; isJumping = false; }

            // Economy
            money += income / 60;
            document.getElementById('money').innerText = "§ " + Math.floor(money);
            document.getElementById('income').innerText = `Income: §${income}/sec`;
            crystal.rotation.y += 0.02;
            crystal.scale.lerp(new THREE.Vector3(1,1,1), 0.1);

            // Purchase Pads
            buyPads.forEach((pad, i) => {
                if(pad.userData.active && player.position.distanceTo(pad.position) < 2) {
                    if(money >= pad.userData.cost) {
                        money -= pad.userData.cost;
                        pad.userData.active = false;
                        scene.remove(pad);
                        pad.userData.onPurchase();
                    }
                }
            });

            const camPos = new THREE.Vector3(0, 6, -14).applyMatrix4(player.matrixWorld);
            camera.position.lerp(camPos, 0.1);
            camera.lookAt(player.position);
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
